% Data generation for tests on rootmusic

% *************************************************************************
% Test 1
% *************************************************************************
% 2 complex sinusoids

rng default;
n = (0:99)';
frqs = [pi/4 pi/4+0.06];

s1 = 2*exp(1j*frqs(1)*n)+1.5*exp(1j*frqs(2)*n)+ ...
    0.5*randn(100,1)+1j*0.5*randn(100,1);
[W1,POW1] = rooteig(s1,2);

save('test1.mat','s1','W1','POW1');


% *************************************************************************
% Test 2
% *************************************************************************
% One real sinusoid

s2 = 2*sin(frqs(1)*n)+0.5*randn(100,1);
[W2,POW2] = rooteig(s2,2);

save('test2.mat','s2','W2','POW2');

% *************************************************************************
% Test 3
% *************************************************************************
% p> required

[W3,POW3] = rooteig(s1,3);

save('test3.mat','W3','POW3');

% *************************************************************************
% Test 4
% *************************************************************************
% p(2) (threshold) also specified which leaves out one sinusoid

frqs = [pi/4 5*pi/8];
s4 = 2*exp(1j*frqs(1)*n)+0.25*exp(1j*frqs(2)*n)+ ...
    1*randn(100,1)+1j*0.5*randn(100,1);
[W4,POW4] = rooteig(s4,[2,2]);

save('test4.mat','s4','W4','POW4');


% *************************************************************************
% Test 5
% *************************************************************************
% Specifying fs

[F5,POW5] = rooteig(s1,2,4e3);
save('test5.mat','F5','POW5');


